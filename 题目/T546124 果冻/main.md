# T546124 果冻

## 题目背景

zjr 生活在一座荒无人烟的小岛上。有一天来了一个名叫 yzy 的探险者，他有一个背包，这个背包里装了成千上万个蒟蒻果冻，十分的美味，zjr 在万年前有幸尝过一次，直到现在还记得它的味道。

zjr 十分想再次吃到蒟蒻果冻，于是他就一直尾随着这个探险者。

## 题目描述

他发现这个探险者走进了一个山洞，这个山洞可以近似于一个 $ n * n $ 的网格图，每一个点用 `.` 或是 `#` 表示，它们分别代表空地和石壁。

zjr 发现这个探险者将他所有的蒟蒻果冻分为了 $m$ 份，每一份有 $s_i$ 个。

山洞的入口为左上角，出口为右下角。

zjr 是个懒惰的人，他不喜欢重复走同一个地方。

zjr 同样是一个贪心的人，本题请计算 zjr 走一遍山洞最多能获得多少蒟蒻果冻。

因为这个山洞的构造可能十分复杂，导致 zjr 可能到不了出口，所以如果 zjr 到达不了出口，输出 $-1$。

## 输入格式

第一行是两个整数 $n$ 和 $m$。

接下来第 $2$ 行至第 $n+1$ 行，每一行 $n$ 个字符，为 `.` 或是 `#`，表示空地或是石壁。

接下来有 $m$ 行，每一行三个整数，为 $x$，$y$，$s$，为坐标为 $(x,y)$ 的位置上有 $s$ 个蒟蒻果冻。左上角为 $(1,1)$ 点，右下角为 $(n,n)$ 点。保证蒟蒻果冻不会出现在石壁之中。

## 输出格式

一个整数，为 zjr 能拿到最多的蒟蒻果冻数量。如果 zjr 无法到达出口，输出 $-1$。

## 输入输出样例 #1

### 输入 #1

```
5 6
.#...
...#.
##.#.
.#.#.
.#...
2 3 1
1 5 1
3 3 4
4 3 5
4 5 1
2 5 4
```

### 输出 #1

```
10
```

## 说明/提示

对于 $ 30\% $ 的数据，数据保证 $n \le 5$。

对于 $ 100\% $ 的数据，数据保证 $1 \le m \le n \le 10$ 且 $1 \le x,y \le n$ 并且 $1 \le s \le 10^{12}$。

[$\color{White}原神，启动！$](https://ys.mihoyo.com/)

# 翻译：
## 張家瑞はこんにゃくゼリーが好きになった 

## 题目背景

zjr は人が住んでいない孤島に住んでいました。ある日、yzy という探検家がやってきました。彼はバックパックを持っており、その中には何千個ものこんにゃくゼリーが入っていました。とても美味しく、zjr は万年前に一度味わったことがあり、今でもその味を覚えていました。

zjr は再びこんにゃくゼリーを食べたいと思い、この探検家をつけ回すことにしました。

## 题目描述

彼は、この探検家が洞窟に入るのを見つけました。この洞窟は $ n * n $ のグリッド図で近似でき、各ポイントは `.` または `#` で表され、それぞれ空地と岩壁を意味します。

zjr は、この探検家がすべてのこんにゃくゼリーを $m$ 個の部分に分け、各部分に $s_i$ 個ずつあることを発見しました。

洞窟の入口は左上隅で、出口は右下隅です。

zjr はわがままな人で、彼が通った場所を再び通るのが嫌いです。

zjr はまた貪欲な人でもあります。この問題では、zjr が洞窟を一度通って得られる最大のこんにゃくゼリーの数を計算してください。

洞窟の構造が非常に複雑なため、zjr が出口に到達できない場合があります。その場合、$-1$ を出力してください。

## 入力フォーマット

最初の行は、2 つの整数 $n$ と $m$ です。

次の $2$ 行目から $n+1$ 行目まで、各行に $n$ 文字の `.` または `#` が入力され、空地または岩壁を表します。

その後、$m$ 行が続き、各行に 3 つの整数 $x$、$y$、$s$ が入力され、座標 $(x,y)$ の位置に $s$ 個のこんにゃくゼリーがあることを示します。左上隅が $(1,1)$ で、右下隅が $(n,n)$ です。こんにゃくゼリーは岩壁の中にはありません。

## 出力フォーマット

zjr が得られる最大のこんにゃくゼリーの数を出力してください。zjr が出口に到達できない場合は、$-1$ を出力してください。

## 入力出力例 #1

### 入力 #1

```
5 6
.#...
...#.
##.#.
.#.#.
.#...
2 3 1
1 5 1
3 3 4
4 3 5
4 5 1
2 5 4
```

### 出力 #1

```
10
```

## 説明/ヒント

$ 30\% $ のデータでは、$n \le 5$ が保証されています。

$ 100\% $ のデータでは、$1 \le m \le n \le 10$ かつ $1 \le x,y \le n$、さらに $1 \le s \le 10^{12}$ が保証されています。